<p-toast></p-toast>
<div style="margin:2%">
  <p-panel header="Queries to be answered" [toggleable]="true" >
    <ng-template pTemplate="icons">
      <button pButton class="p-panel-header-icon p-link" (click)="menu.toggle($event)">
        
      </button>
      <p-menu #menu id="config_menu" [model]="listquery" [popup]="true"></p-menu>
    </ng-template>


    <div class="p-4">
      <p-table #dt1 [paginator]="true" [rows]="10" [value]="listquery" [rowHover]="true" [responsive]="true"
        styleClass="p-datatable-gridlines p-datatable-striped" [globalFilterFields]="['query','createdby','answer', 'full_name', 'datetime']">

        

        <ng-template pTemplate="caption">
          <div class="mt-3 md:mt-0" style="text-align:right">
            <span class="p-input-icon-left p-ml-auto">
              <i class="pi pi-search"></i>

              <input pInputText type="text" (input)="dt1.filterGlobal($any($event.target).value, 'contains')"
                placeholder="Search" />
            </span>
          </div>

        </ng-template>

        <ng-template pTemplate="header">
          <tr>
            <th pSortableColumn="query" style="text-align: center; width:25%">Query<p-sortIcon field="query">

              </p-sortIcon>
            </th>
            <th pSortableColumn="createdby" style="text-align: center; width:20%">Created By<p-sortIcon
                field="createdby">
              </p-sortIcon>
            </th>
            <th pSortableColumn="Answer" style="text-align: center; width:20%">Answer
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-columns let-i="rowIndex">
          <tr>
            <td style="text-align: center;">{{columns.query}}</td>
            <td style="text-align: center;">{{columns.full_name}}</td>
            <td style="text-align: center;"><button pButton pRipple icon="pi pi-pencil" pTooltip="Answer Query"
                tooltipPosition="top" class="p-button-rounded p-button-success p-mr-3" style=" margin-right: 15px;"
                (click)="Query(columns.srno)"></button></td>
          </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
          <span style="text-align: center;">
                  <div style="text-align: center; margin: 2%;" >
                    <strong> No Queries Present </strong>
                  </div>
          </span>
      </ng-template>
      </p-table>
    </div>
  </p-panel>

  <br>
  <p-panel header="All Queries" [toggleable]="true" >
    <ng-template pTemplate="icons">
      <button pButton class="p-panel-header-icon p-link" (click)="menu.toggle($event)">
        
      </button>
      <p-menu #menu id="config_menu" [model]="listquery1" [popup]="true"></p-menu>
    </ng-template>


    <div class="p-4">
      <p-table #dt2 [paginator]="true" [rows]="10" [value]="listquery1" [rowHover]="true" [responsive]="true"
        styleClass="p-datatable-gridlines p-datatable-striped" [globalFilterFields]="['query','createdby','answer', 'full_name', 'datetime']">

        

        <ng-template pTemplate="caption">
          <div class="mt-3 md:mt-0" style="text-align:right">
            <span class="p-input-icon-left p-ml-auto">
              <i class="pi pi-search"></i>

              <input pInputText type="text" (input)="dt2.filterGlobal($any($event.target).value, 'contains')"
                placeholder="Search" />
            </span>
          </div>

        </ng-template>

        <ng-template pTemplate="header">
          <tr>

            <th pSortableColumn="query" style="text-align: center; width:25%">Query<p-sortIcon field="query">

              </p-sortIcon>

            </th>
            <th pSortableColumn="createdby" style="text-align: center; width:20%">Created By<p-sortIcon
                field="createdby">

              </p-sortIcon>

            </th>
            <th pSortableColumn="Answer" style="text-align: center; width:20%">Answer

            </th>

          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-columns let-i="rowIndex">
          <tr>

            <td style="width: 50%; overflow-wrap: break-word; text-align: center; ">{{columns.query}}</td>
            <td style="text-align: center;">{{columns.full_name}}</td>
            <td style="text-align: center;">{{columns.answer}}</td>
          </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
          <span style="text-align: center;">

                  <div style="text-align: center; margin: 2%;" >
                    <strong> No Queries Present </strong>
                  </div>
          </span>
      </ng-template>

      </p-table>
    </div>
  </p-panel>

  <p-dialog [(visible)]="querydialog" [style]="{width: '800px'}" header="Answer to the Query" [modal]="true"
    styleClass="p-fluid">
    <ng-template pTemplate="content">

      <div class=" md:align-items-center md:justify-content-between md:flex-row">
        <div class="font-medium " style="padding: 1%;">
          
          <span style="width: 100%; overflow-wrap: break-word;" > {{query}} </span>
        </div>
        <div style="padding: 1%;">
          <textarea rows="6" cols="80" pInputTextarea [(ngModel)]="answer"></textarea>
        </div>
      </div>

    </ng-template>

    <ng-template pTemplate="footer">

      <button pButton pRipple type="button" label="Save" class="p-button-success" (click)="Save()"></button>
      <button pButton pRipple type="button" label="Cancel" class="p-button-danger" (click)="hide()"></button>

    </ng-template>
  </p-dialog>

</div>
