<div class="surface-ground border-top-1 border-bottom-1 border-gray-300 px-4 py-3">
  <div class="flex flex-column md:align-items-center md:justify-content-between md:flex-row">
    <div class="font-medium text-3xl text-900">Manage permissions</div>
    <div class="mt-3 md:mt-0">
      <button pTooltip="Cancel" [routerLink]="['/admin']" tooltipPosition="top" label="Cancel"
        pButton pRipple style="margin-left: 4px;" type="button" icon="pi pi-times" class="p-button-primary"></button>
    </div>
  </div>
</div>

<div class="p-5">
  <div>
    <div class="surface-card shadow-2 border-round p-4">
      <div class="flex align-items-center px-2 flex-wrap">
        <div class="md:w-11"><b>Manage Role Permissions</b></div>
        <div class="w-6 md:w-1">
          <button pButton pRipple label="Save" icon="pi pi-save" class="p-button-primary"
            (click)="savePermission()"></button>
        </div>
      </div>
      <p-divider></p-divider>

      <div class="mb-5" *ngFor="let item of keys;">
        <p-panel header={{item}} [toggleable]="true" [collapsed]="true"
          *ngIf="returnArray(TotalAccess[item]).length != 0">
          <p-table [columns]="totalPermission" [value]="returnArray(TotalAccess[item])" responsiveLayout="scroll">
            <ng-template pTemplate="header" let-columns>
              <tr>
                <th>Category</th>
                <th *ngFor="let col of columns">
                  {{col.permission}}
                </th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-rowData let-columns="columns">
              <tr>
                <td>{{rowData}}</td>
                <td *ngFor="let col of columns; let i = index">
                  <p-inputSwitch *ngIf="TotalAccess[item][rowData][col.permission] == null"
                    [(ngModel)]="TotalAccess[item][rowData][col.permission]"
                    (onChange)="editPermission(item,rowData,col.permission,TotalAccess[item][rowData][col.permission])"
                    [disabled]="true"></p-inputSwitch>
                  <p-inputSwitch *ngIf="TotalAccess[item][rowData][col.permission] != null"
                    [(ngModel)]="TotalAccess[item][rowData][col.permission]"
                    (onChange)="editPermission(item,rowData,col.permission,TotalAccess[item][rowData][col.permission])">
                  </p-inputSwitch>
                </td>
              </tr>
            </ng-template>
          </p-table>
        </p-panel>
      </div>
    </div>
  </div>
</div>

<!-- 
<div class="p-5">
  <div class="surface-card shadow-2 border-round p-4">
    <div class="flex align-items-center justify-content-between mb-4 text-900 font-medium text-xl">Bughuntr Admin Role Assignment</div>
    <p-divider></p-divider>
    <div class="mb-5 grid">
      <div class="col-12 md:col-6 grid">
        <label class="col-12 md:col-3 text-900 font-medium text-xl">Employee ID :</label>
        <div class="col-12 md:col-6">
          <input pInputText="text" [(ngModel)]="admin_role_bounty_id" pInputText placeholder="Enter Employee ID" style="width: 100%;" />
        </div>
        <div class="col-12 md:col-3">
          <p-button label="Add" (click)="getAdminEmployeeName()" icon="pi pi-plus"></p-button>
        </div>
      </div>
    </div>
  </div>
</div>


<div class="p-5">
  <div class="surface-card shadow-2 border-round p-4">
    <div class="flex align-items-center justify-content-between mb-4 text-900 font-medium text-xl">Bounty Admin Role Assignment</div>
    <p-divider></p-divider>
    <div class="mb-5 grid">
      <div class="col-12 md:col-6 grid">
        <label class="col-12 md:col-3 text-900 font-medium text-xl">Employee ID :</label>
        <div class="col-12 md:col-6">
          <input pInputText="text" [(ngModel)]="role_bounty_id" pInputText placeholder="Enter Employee ID" style="width: 100%;" />
        </div>
        <div class="col-12 md:col-3">
          <p-button label="Add" (click)="getprgAdminEmployeeName()" icon="pi pi-plus"></p-button>
        </div>
      </div>
    </div>
  </div>
</div> -->


<p-dialog header="Title" [(visible)]="display">
  <p-table [value]="ActualPermission">
    <ng-template pTemplate="header" let-columns>
      <tr>
        <th>Role</th>
        <th>Module</th>
        <th>Sub Module</th>
        <th>Permission</th>
        <th>Status</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-rowData>
      <tr>
        <td>{{rowData.roleName}}</td>
        <td>{{rowData.module}}</td>
        <td>{{rowData.submodule}}</td>
        <td>{{rowData.permission}}</td>
        <td>
          <p-inputSwitch [(ngModel)]="rowData.status" [disabled]="true"></p-inputSwitch>
        </td>
      </tr>
    </ng-template>
  </p-table>
  <ng-template pTemplate="footer">
    <button pButton pRipple label="Confirm" icon="pi pi-save" class="p-button-text"
      (click)="UpdatePermisions();display = false"></button>
    <button pButton pRipple label="Cancel" icon="pi pi-times" class="p-button-text p-button-danger"
      (click)="display = false"></button>
  </ng-template>
</p-dialog>


<p-dialog [(visible)]="displayAdminName" appendTo="body" [modal]="true" [breakpoints]="{'960px': '75vw', '640px': '100vw'}" [style]="{width: '40vw'}" [closable]="false" [showHeader]="false">
  <div class="flex flex-column align-items-center my-4">
      <span class="flex align-items-center justify-content-center bg-cyan-100 text-cyan-800 mr-3 border-circle mb-3" style="width:64px;height:64px">
          <i class="pi pi-user text-5xl"></i>
      </span>
      <div class="font-medium text-2xl text-900">Employee Name</div>
      <div class="font-medium text-2xl text-600">{{employeeName}}</div>
  </div>
  <p class="line-height-3 p-0 m-0 flex flex-column align-items-center my-4">
      Are you sure, you want to provide Bughuntr Admin access?
  </p>
  <ng-template pTemplate="footer">
      <div class=" border-top-1 surface-border pt-3 flex">
          <button pButton pRipple icon="pi pi-times" (click)="displayAdminName = false; admin_role_bounty_id=''" label="Cancel" class="p-button-outlined w-6 mr-2"></button>
          <button pButton pRipple icon="pi pi-check" (click)="displayAdminName = false; AddBughuntrAdminRole()" label="Save" class="w-6 ml-2"></button>
      </div>
  </ng-template>
</p-dialog>

<p-dialog [(visible)]="displayPrgAdminName" appendTo="body" [modal]="true" [breakpoints]="{'960px': '75vw', '640px': '100vw'}" [style]="{width: '40vw'}" [closable]="false" [showHeader]="false">
  <div class="flex flex-column align-items-center my-4">
      <span class="flex align-items-center justify-content-center bg-cyan-100 text-cyan-800 mr-3 border-circle mb-3" style="width:64px;height:64px">
          <i class="pi pi-user text-5xl"></i>
      </span>
      <div class="font-medium text-2xl text-900">Employee Name</div>
      <div class="font-medium text-2xl text-600">{{employeeName}}</div>
  </div>
  <p class="line-height-3 p-0 m-0 flex flex-column align-items-center my-4">
      Are you sure, you want to provide Bounty Program Admin access?
  </p>
  <ng-template pTemplate="footer">
      <div class=" border-top-1 surface-border pt-3 flex">
          <button pButton pRipple icon="pi pi-times" (click)="displayPrgAdminName = false; role_bounty_id=''" label="Cancel" class="p-button-outlined w-6 mr-2"></button>
          <button pButton pRipple icon="pi pi-check" (click)="displayPrgAdminName = false; AddBugBountyRole()" label="Save" class="w-6 ml-2"></button>
      </div>
  </ng-template>
</p-dialog>